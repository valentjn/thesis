\section{Hierarchization on Dimensionally Adaptive Sparse Grids}
\label{sec:43dimAdaptive}

\blindtext{}



\subsection{Combination Technique and Combinatorial Proof}
\label{sec:431combiTechniqueProof}

\todo{mention Delvos/Schempp}

\todo{mention Wasilkowski}

\blindtext{}

\paragraph{Formal description and outline of a combinatorial proof}

In the following, we give a formal description of the
sparse grid combination technique and we outline a combinatorial proof
for its correctness.
We discuss a high-level explanation of the proofs in this section
The proofs themselves can be found in \cref{sec:proofCombiTechnique}
as most of them are rather technical.
For simplicity,
we formulate the combination technique and its proof for regular
sparse grids (see \cref{sec:231regularSG}).
However, the main ideas of the proof chain are also applicable
for dimensionally adaptive sparse grids
(see \cref{sec:232dimensionallyAdaptiveSG}).

\begin{theorem}[sparse grid combination technique]
  Let $\liset := \{(\*l, \*i) \mid
  \normone{\*l} \le n,\; \*i \in \hiset{\*l}\}$
  correspond to the regular sparse grid
  $\regsgset{n}{d}{}$ and let $(\fcnval{\*l,\*i})_{(\*l,\*i) \in \liset}$
  be given function values on $\regsgset{n}{d}{}$.
  If we define
  \begin{itemize}
    \item
    the combined sparse grid interpolant $\regsgintp{n}{d}{\ct}$ via
    \eqref{eq:combiTechnique}, i.e.,
    \begin{equation}
      \regsgintp{n}{d}{\ct}
      = \sum_{q=0}^{d-1} (-1)^q \binom{d-1}{q} \sum_{\normone{\*l} = n-q}
      \fgintp{\*l},
    \end{equation}
    where $\fgintp{\*l} \in \ns{\*l}$ is the full grid interpolant
    of $f$ with level $\*l$, and
    
    \item
    the hierarchical sparse grid interpolant $\regsgintp{n}{d}{}$
    via \eqref{eq:hierarchizationProblem} and
    \eqref{eq:hierarchizationInterpolant},
  \end{itemize}
  then the combined and the hierarchical sparse grid interpolants coincide:
  \begin{equation}
    \regsgintp{n}{d}{}
    = \regsgintp{n}{d}{\ct}.
  \end{equation}
\end{theorem}

\begin{proof}[Proof (sketch)]
  \blindtext{}
\end{proof}

\begin{restatable}[inclusion-exclusion principle]{%
  proposition%
}{%
  propCombiTechniqueOne%
}
  \label{prop:combiTechniqueOne}
  For every $\gp{\*l,\*i} \in \regsgset{n}{d}{}$, we have
  \begin{equation}
    \label{eq:combiTechniqueOne}
    \sum_{q=0}^{d-1} (-1)^q \binom{d-1}{q} \cdot
    \setsize{
      \{\*l' \mid \normone{\*l'} = n - q,\; \fgset{\*l'} \ni \gp{\*l,\*i}\}
    }
    = 1.
  \end{equation}
\end{restatable}

\begin{proof}
  See \cref{sec:proofCombiTechnique}.
\end{proof}

\begin{definition}[relation ``$\sim$'']
  \label{def:combiTechniqueEquivalenceRelation}
  Let $\gp{\*l,\*i} \in \regsgset{n}{d}{}$ be fixed and
  \begin{equation}
    \label{eq:combiTechniqueSpecialLevelSet}
    \levelset
    := \{\*l' \mid \ex{q=0,\dotsc,d-1}{
      \normone{\*l'} = n - q,\; \fgset{\*l'} \notni \gp{\*l,\*i}
    }\}
  \end{equation}
  be the set of levels that do not contain $\gp{\*l,\*i}$.
  We define a relation ``$\sim$'' on $L$ as follows:
  For $\*l', \*l'' \in L$, we set $\*l' \sim \*l''$ if and only if
  \begin{equation}
    \fa{t \notin T_{\*l',\*l''}}{\min\{l'_t, l''_t\} \ge l_t},\quad
    T_{\*l',\*l''}
    := \{t \mid l'_t = l''_t\}.
  \end{equation}
\end{definition}

\begin{restatable}{%
  shortlemma%
}{%
  lemmaCombiTechniqueIdenticalValues%
}
  \label{lemma:combiTechniqueIdenticalValues}
  Let $\*l', \*l'' \in L$ with $\*l' \sim \*l''$.
  Then, $\fgintp{\*l'}(\gp{\*l,\*i})
  = \fgintp{\*l''}(\gp{\*l,\*i})$.
\end{restatable}

\begin{proof}
  See \cref{sec:proofCombiTechnique}.
\end{proof}

\todo{add notation for equivalence class, replace}

\begin{restatable}[characterization of the equivalence classes of ``$\sim$'']{%
  lemma%
}{%
  lemmaCombiTechniqueCharacterization%
}
  \label{lemma:combiTechniqueCharacterization}
  Let $L_0 \in L/{\sim}$ be an equivalence class of ``$\sim$''.
  If we define
  \begin{equation}
    T_{L_0}
    := \{t \mid \exfa{l^\ast_t}{\*l' \in L_0}{l'_t = l^\ast_t}\}
  \end{equation}
  as the set of dimensions in which all levels in $L_0$
  have the same entry, then
  \begin{equation}
    L_0
    = \{\*l' \in L \mid
    \fa{t \in T_{L_0}}{l'_t = l^\ast_t},\;
    \fa{t \notin T_{L_0}}{l'_t \ge l_t}\}.
  \end{equation}
\end{restatable}

\begin{proof}
  See \cref{sec:proofCombiTechnique}.
\end{proof}

\begin{restatable}[function value cancellation]{%
  proposition%
}{%
  propCombiTechniqueZero%
}
  \label{prop:combiTechniqueZero}
  For every $\gp{\*l,\*i} \in \regsgset{n}{d}{}$, we have
  \begin{equation}
    \sum_{q=0}^{d-1} (-1)^q \binom{d-1}{q} \cdot
    \sum_{\substack{\normone{\*l'} = n - q\\\fgset{\*l'} \notni \gp{\*l,\*i}}}
    \fgintp{\*l'}(\gp{\*l,\*i})
    = 0.
  \end{equation}
\end{restatable}

\begin{proof}
  See \cref{sec:proofCombiTechnique}.
\end{proof}

\blindtext{}



\subsection{Hierarchization with the Combination Technique}
\label{sec:432hierarchizationCombiTechnique}

\blindtext{}

\subsection{%
  Hierarchization by Successive Applications of the Unidirectional Principle%
}
\label{sec:433hierarchizationSuccessiveUP}

\blindtext{}
