\setdictum{%
  Who are you? How did you get in my house?%
}{%
  Donald E. Knuth about one-based array indices in algorithms
  (according to \texttt{xkcd}\footnotemark)%
}

\chapter{Algorithms for B-Splines on Sparse Grids}
\footnotetext{\url{https://xkcd.com/163/}}

%\lettrine{A}{s} we have seen in the last chapter,
%hierarchical B-splines constitute an interesting basis on sparse grids,
%enabling smooth approximations of objective functions.
%When correctly incorporating boundary conditions into the hierarchical basis,
%the basis can exactly represent polynomials,
%which is a prerequisite for higher approximation orders.

\lettrine{L}{et}
us study the algorithmic challenges that the new hierarchical B-spline
bases pose.
As we are usually not able to apply the sparse grid algorithms
that were designed for hat functions, we have to generalize the algorithms
to higher-order B-splines or even to arbitrary tensor product basis functions.
We learn in this chapter that the main problem is the larger support
of higher-order B-splines (degree $p > 1$) when compared to degree $p = 1$.
Unfortunately, it is not possible to simply ``transform'' the basis
functions $\bspl{l,i}{p}{}$ to shrink the size of their support
to $\supp \bspl{l,i}{1}{}$.

In this chapter, we give an overview of algorithms for B-splines
on sparse grids.
Some algorithms are already known from the literature,
while others are new.
In any case, we give correctness results for every algorithm.
We take hierarchization as the example problem for our algorithms,
but the algorithms can be generalized to any linear operator.
Furthermore, most algorithms are not tailored for B-splines $\bspl{l,i}{p}{}$,
but applicable for general tensor product basis functions $\basis{l,i}$.
The types of feasible approaches for algorithms
depend on the ``regularity'' of the sparse grid at hand
(full grid/dimensionally adaptive sparse grid/spatially adaptive sparse grid).
Naturally, the more assumptions the grid satisfies, the faster and
easier will the corresponding algorithms be.

\Cref{sec:41problem} explains hierarchization as our example problem
and defines the notation used in this chapter.
The remaining three sections treat the different cases of grids:
First, \cref{sec:42fullGrids} deals with full grids to formalize and repeat
the well-known unidirectional principle.
Second, \cref{sec:43dimAdaptive} studies algorithms for
sparse grids that have been generated dimensionally adaptively.
Third, \cref{sec:44spatAdaptive} treats the for us most important case
of arbitrary (spatially adaptive) sparse grids.

This original chapter is the main theoretical contribution of this thesis.
Although the unidirectional principle in \cref{sec:42fullGrids} and
the combination technique in \cref{sec:43dimAdaptive} are well-known,
the presentation with formal proofs of correctness is new.
Parts of the chapter have already been published in scientific papers
\cite{Valentin18Fundamental}.



\input{41problem}
\input{42fullGrids}
\input{43dimAdaptive}
\input{44spatAdaptive}

\cleardoublepage
