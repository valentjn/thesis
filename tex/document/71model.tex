\section{Continuum-Mechanical Model of the Upper Limb}
\label{sec:71model}

\minitoc{71mm}{5}

\noindent
In the following, we first discuss the state of the art
in biomechanical modeling.
Then, we address the details of the model of the human upper limb
such as its parameters and its geometry.
For convenience, the most relevant symbols that occur
in the context of biomechanical models are listed in
\cref{tbl:glossaryBiomechanical}.

\begin{table}
  \setnumberoftableheaderrows{0}%
  \newcommand*{\pnst}[1]{\printnotationsymbol{#1}&\printnotationtext{#1}}%
  \begin{tabular}{%
      >{\kern\tabcolsep}=l+l<{\kern5mm}+l+l<{\kern5mm}+l+l<{\kern\tabcolsep}%
    }
    \toprulec
    \pnst{\forcetriceps}& \pnst{\armtriceps}& \pnst{\elbowangle}\\
    \pnst{\forcebiceps}&  \pnst{\armbiceps}&  &\\
    \pnst{\forceload}&    \pnst{\armload}&    &\\
    \bottomrulec
  \end{tabular}%
  \caption[Glossary for biomechanical models]{%
    Glossary of the notation for biomechanical models.%
  }%
  \label{tbl:glossaryBiomechanical}%
\end{table}



\subsection{Continuum-Mechanical Musculoskeletal Models}
\label{sec:711models}

\paragraph{Limitations of lumped-parameter models}

Due to the simplicity and computational efficiency of
classical lumped-parameter models,
their degree of realism is limited.
Without any modifications,
lumped-parameter models are not able to represent
detailed heterogeneous material characteristics or non-trivial
muscle force paths \cite{Roehrle16Two}.

\paragraph{Benefits of continuum-mechanical models}

The exploitation of continuum-mechani\-cal constitutive laws
for musculoskeletal models is a more recent development \cite{Roehrle16Two}.
The resulting models are capable to model spatial quantities
such as complex muscle fiber field architectures,
local activation principles, complex muscle geometries, or contact mechanics
\multicite{Roehrle16Two,Valentin18Gradient}.
Most of existing work only treats a single skeletal muscle in isolation
\multicite{Lemos05Modeling,Sharafi11Strains,Heidlauf14Multiscale}.
The goal of the model used in this thesis
(which is the same model as in
\multicite{Sprenger15Continuum,Roehrle16Two,Valentin18Gradient})
is to study the interplay of multiple muscles and bones.

\paragraph{Overdetermined antagonistic systems}

Musculoskeletal systems are typically overdetermined \cite{Roehrle16Two}.
This means that the number of muscles that act on a specific joint
is usually larger than the number of the joint's degrees of freedom.
For instance, in a simple model of the upper limb,
there are two antagonistic muscles
(i.e., muscles that work against each other), namely biceps and triceps,
but only one joint angle at the elbow.
Mathematically speaking, a single muscle would suffice to attain
most elbow angles that are possible with an antagonistic muscle pair.
However, the usage of two muscles enables faster movements and
allows for abrupt changes of direction.

The overdetermination of most musculoskeletal models
implies that additional conditions have to be imposed in order
to obtain unique solutions.
There exist various types of such conditions,
for instance, minimal control effort, minimal control change, and
minimal kinematic energy \cite{Valentin18Gradient}.
The idea behind all of these conditions is that the human body
tries to minimize the energy effort that is associated with
most types of motion.

\paragraph{Forward and inverse dynamics}

Musculoskeletal simulations are usually based on
either forward dynamics or inverse dynamics \cite{Valentin18Gradient}.
\term{Forward-dynamic approaches} use activation parameters
for the muscles as the input and simulate the corresponding motion
as the output.
This requires that we know the muscle forces beforehand,
depending on the activation levels.
For example, one can prescribe activation levels of facials muscles
to achieve specific facial expressions \cite{Wu13Modelling}.
In contrast, \term{inverse-dynamic approaches}
use experimental motion data as the input
to estimate the muscle forces as the output \cite{Roehrle16Two}.
With inverse-dynamic simulations,
one can investigate the wrapping of muscles
around the knee joint \cite{Fernandez05Anatomically} or
visualize the motion of skin \cite{Lee09Comprehensive}, for instance.



\subsection{Details of the Human Upper Limb Model}
\label{sec:712details}

\begin{figure}
  \begin{tikzpicture}[
    dashed/.style={dash pattern=on 2pt off 2pt},
    contour/.style={line width=3pt,draw=mittelblau!10},
  ]
    \newcommand*{\myhspace}{30.34mm}
    \newcommand*{\myscale}{0.14}
    \newcommand*{\mybicepsstart}{0.2}
    \newcommand*{\myradius}{9mm}
    \newcommand*{\mysmallradius}{2mm}
    
    \foreach \myi in {1,...,5} {
      \node[anchor=north west] at ({(\myi-1)*\myhspace},0mm) {%
        \includegraphics[scale=\myscale]{upperLimb_\myi}%
      };
      \node[anchor=north west] at ({(\myi-1)*\myhspace+11mm},0mm) {%
        \pgfmathparse{10+35*(\myi-1)}%
        $\theta = \SI[
          round-mode=places,round-precision=0,
        ]{\pgfmathresult}{\degree}$%
      };
    }
    
    \begin{scope}[shift={({(3-1)*\myhspace},0mm)}]
      \coordinate (joint)               at (8mm,-30mm);
      \coordinate (loadForceStart)      at (30.6mm,-35mm);
      \coordinate (loadForceEnd)        at (30.6mm,-45mm);
      \coordinate (tricepsForceStart)   at (5.7mm,-31.9mm);
      \coordinate (tricepsForceEnd)     at (4mm,-15mm);
      \coordinate (bicepsForceStart)    at (
        ${(1-\mybicepsstart)}*(joint) + \mybicepsstart*(loadForceStart)$
      );
      \coordinate (bicepsForceEnd)      at (11.5mm,-10mm);
      \coordinate (horizontalDashedEnd) at ($(loadForceEnd) + (0mm,3mm)$);
      \coordinate (verticalDashedEnd)   at ($(joint) - (0mm,15mm)$);
      \pgfmathanglebetweenpoints{
        \pgfpointanchor{joint}{center}
      }{
        \pgfpointanchor{loadForceStart}{center}
      }
      \let\myelbowangle\pgfmathresult
      \coordinate (arcStart) at ($(joint) - (0mm,\myradius)$);
      \coordinate (arcEnd) at (
        $(joint) + (
          {\myradius*cos(\myelbowangle)},
          {\myradius*sin(\myelbowangle)}
        )$
      );
      
      \draw[contour] (tricepsForceStart) -- (joint) -- (loadForceStart);
      
      \draw[dashed,contour] (joint) -- (verticalDashedEnd);
      \draw[dashed,contour] (
        $(joint)!(horizontalDashedEnd)!(verticalDashedEnd)$
      ) -- (horizontalDashedEnd);
      \draw[dashed,contour] (joint) -- (
        $(tricepsForceStart)!(joint)!(tricepsForceEnd)$
      );
      \draw[dashed,contour] (joint) -- (
        $(bicepsForceStart)!(joint)!(bicepsForceEnd)$
      );
      \centerarc[dashed,contour](joint)(270:\myelbowangle:\myradius);
      
      \draw[
        ->,contour,>={Stealth[width=9pt,length=9pt]},
      ] (tricepsForceStart) -- (
        $(tricepsForceEnd)!-1.5pt!(tricepsForceStart)$
      );
      \draw[
        ->,contour,>={Stealth[width=9pt,length=9pt]},
      ] (bicepsForceStart) -- (
        $(bicepsForceEnd)!-1.5pt!(bicepsForceStart)$
      );
      \draw[
        ->,contour,>={Stealth[width=9pt,length=9pt]},
      ] (loadForceStart) -- (
        $(loadForceEnd)!-1.5pt!(loadForceStart)$
      );
      
      \draw (tricepsForceStart) -- (joint) -- (loadForceStart);
      
      \draw[dashed] (joint) -- (verticalDashedEnd);
      \centerarc[dashed](joint)(270:\myelbowangle:\myradius);
      
      \newcommand*{\drawleverarm}[4]{
        \coordinate (leverArmBase) at ($(#2)!(#1)!(#3)$);
        \draw[dashed,draw=C1] (#1) -- (leverArmBase);
        \pgfmathanglebetweenpoints{
          \pgfpointanchor{#1}{center}
        }{
          \pgfpointanchor{leverArmBase}{center}
        }
        \let\myangle\pgfmathresult
        \pgfmathparse{\myangle #4 180}
        \let\mystartangle\pgfmathresult
        \pgfmathparse{\myangle #4 90}
        \let\myendangle\pgfmathresult
        \centerarc[draw=C1](leverArmBase)(
          \mystartangle:\myendangle:\mysmallradius
        );
        \fill[draw=none,fill=C1] (
          $(leverArmBase) + (
            {0.62*\mysmallradius*cos((\mystartangle+\myendangle)/2)},
            {0.62*\mysmallradius*sin((\mystartangle+\myendangle)/2)}
          )$
        ) circle (1pt);
      }
      \drawleverarm{horizontalDashedEnd}{joint}{verticalDashedEnd}{-}
      \drawleverarm{joint}{tricepsForceStart}{tricepsForceEnd}{-}
      \drawleverarm{joint}{bicepsForceStart}{bicepsForceEnd}{+}
      
      \draw[->,draw=C0] (tricepsForceStart) -- (tricepsForceEnd);
      \draw[->,draw=C0] (bicepsForceStart) -- (bicepsForceEnd);
      \draw[->,draw=C0] (loadForceStart) -- (loadForceEnd);
      
      \fill[draw=none,fill=black] (joint) circle (2pt);
      
      \node at (
        $(joint) + (
          {0.62*\myradius*cos((270+\myelbowangle)/2)},
          {0.62*\myradius*sin((270+\myelbowangle)/2)}
        )$
      ) {\contour{mittelblau!10}{$\elbowangle$}};
      
      \node[anchor=south] at (
        $0.5*(joint) +
        0.5*(tricepsForceStart)!(joint)!(tricepsForceEnd) +
        (-1mm,1mm)$
      ) {\contour{mittelblau!10}{\textcolor{C1}{$\armtriceps$}}};
      \node[anchor=south] at (
        $0.5*(joint) +
        0.5*(bicepsForceStart)!(joint)!(bicepsForceEnd) +
        (1mm,1mm)$
      ) {\contour{mittelblau!10}{\textcolor{C1}{$\armbiceps$}}};
      \node[anchor=north] at (
        $0.5*(horizontalDashedEnd) +
        0.5*(joint)!(horizontalDashedEnd)!(verticalDashedEnd) +
        (0mm,-1mm)$
      ) {\contour{mittelblau!10}{\textcolor{C1}{$\armload$}}};
      
      \node[anchor=east] at (
        $0.2*(tricepsForceStart) + 0.8*(tricepsForceEnd) + (-1mm,0mm)$
      ) {\contour{mittelblau!10}{\textcolor{C0}{$\forcetriceps$}}};
      \node[anchor=west] at (
        $0.2*(bicepsForceStart) + 0.8*(bicepsForceEnd) + (1mm,0mm)$
      ) {\contour{mittelblau!10}{\textcolor{C0}{$\forcebiceps$}}};
      \node[anchor=west] at (
        $0.2*(loadForceStart) + 0.8*(loadForceEnd) + (1mm,0mm)$
      ) {\contour{mittelblau!10}{\textcolor{C0}{$\forceload$}}};
    \end{scope}
  \end{tikzpicture}%
  \caption[Raising arm movement]{%
    Human upper limb model geometry shown as a raising arm movement
    for the elbow angles
    $\theta = \SI{10}{\degree}$, \SI{45}{\degree}, \SI{80}{\degree},
    \SI{115}{\degree}, and \SI{150}{\degree} \emph{(from left to right).}
    For $\theta = \SI{80}{\degree}$,
    the contributing forces \emph{\textcolor{C0}{(blue)}} and
    lever arms \emph{\textcolor{C1}{(red)}} are shown.
    Taken and adapted from
    \multicite{Sprenger15Continuum,Valentin18Gradient}.%
  }%
  \label{fig:raisingArm}%
\end{figure}

\paragraph{Overall stress}

\cite{Soennerlind13Why}

\dummytext{}

\paragraph{Parameters, geometry, and implementation}

\cite{Spitzer96Visible}
\cite{Sprenger15Continuum}

\todo{mention CMISS}

\dummytext{}
