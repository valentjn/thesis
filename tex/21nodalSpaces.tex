\section{Nodal Basis and Nodal Space}
\label{sec:21nodalSpaces}



\subsection{Univariate Case}
\label{sec:211nodalUV}

\paragraph{Grid and basis functions}

Let us first consider univariate functions
that are defined on the unit interval $\clint{0, 1}$.
\usenotation{l}
We discretize this domain by splitting it into $2^l$ equally sized segments,
where $l \in \natz$ is the \term{level}.
\usenotation{i}
The resulting $2^l + 1$ \term{grid points} $\gp{l,i}$ are given by
\begin{equation}
  \gp{l,i} := i \cdot \ms{l},\quad
  i = 0, \dotsc, 2^l,
\end{equation}
where $i$ is the \term{index} and $\ms{l} := 2^{-l}$ is the \term{mesh size}.%
\footnote{%
  Note that from a strict formal perspective,
  this equation defined $\gp{l,i}$ only for $i = 0, \dotsc, 2^l$,
  but we will later need $\gp{l,i}$ also for $i < 0$ or $i > 2^l$.
  The convention in this thesis is that all definitions are
  implicitly generalized whenever needed.%
}
Every grid point is associated with a \term{basis function}
\begin{equation}
  \basis{l,i}\colon \clint{0, 1} \to \real.
\end{equation}
In this thesis, we assume $\basis{l,i}$ to be arbitrary,
satisfying required assumptions when needed and stated.
However, it helps for both the theory and the intuition to have a
specific example of basis functions in mind.
\usenotation{.1}
The so-called \term{hat functions} (linear B-splines), which are defined as
\begin{equation}
  \label{eq:hatFunctionUV}
  \basis{l,i}^1(x)
  := \max(1 - \abs{\tfrac{x}{\ms{l}} - i}, 0),
\end{equation}
are the most common choice for $\basis{l,i}$.
Here and in the following,
the superscript ``1'' is the degree of the linear B-spline and
is not to be read as an exponent.
We generalize this notation to B-splines $\basis{l,i}^p$ of
arbitrary degrees $p$ in \cref{chap:30BSplines}.

\paragraph{Nodal space}

The \emph{nodal space} $\ns{l}$ of level $l$
is defined as the linear span of all basis functions
$\basis{l,i}$:
\begin{equation}
  \ns{l} := \spn\{\basis{l,i} \mid i = 0, \dotsc, 2^l\}.
\end{equation}
We assume that the functions $\basis{l,i}$ form a basis of $\ns{l}$, i.e.,
every linear combination of these functions is unique.
This ensures that for every objective function $f\colon \clint{0, 1} \to \real$,
there is a unique function $\fgintp{l}\colon \clint{0, 1} \to \real$ such that
\begin{equation}
  \label{eq:interpFullGridUV}
  \fgintp{l}
  = \sum_{i=0}^{2^l} \interpcoeff{i} \basis{l,i},\quad
  \fa{i = 0, \dotsc, 2^l}{\fgintp{l}(\gp{l,i}) = f(\gp{l,i})},
\end{equation}
for some $\interpcoeff{i} \in \real$.
In this case, $\fgintp{l}$ is called \term{interpolant} of $f$ in $\ns{l}$.
The nodal space $\ns{l}^1$ is defined analogously as the span of the
hat functions $\basis{l,i}^1$.
It is the space of all linear splines,
that is, the space of all continuous functions on $\clint{0, 1}$ that are
piecewise linear polynomials on $\clint{\gp{l,i}, \gp{l,i+1}}$ for
$i = 0, \dotsc, 2^l - 1$ \cite{Hoellig13Approximation}.
The nodal hat function basis of level~$l = 3$
and a linear combination are shown in \cref{fig:nodalHat}.

\begin{figure}
  \subcaptionbox{%
    Basis functions $\basis{l,i}^1$ ($i = 0, \dotsc, 2^l$)
    and grid points $\gp{l,i}$ \emph{(dots)}.%
  }[75mm]{%
    \includegraphics{nodalHat_1}%
  }%
  \hfill%
  \subcaptionbox{%
    Piecewise linear interpolant $\fgintp{l}^1$ as a weighted sum
    of the nodal hat functions.%
  }[75mm]{%
    \includegraphics{nodalHat_2}%
  }%
  \caption{Univariate nodal hat functions of level $l = 3$.}
  \label{fig:nodalHat}
\end{figure}



\subsection{Multivariate Case}
\label{sec:212nodalMV}

\paragraph{Cartesian and tensor products}

\usenotation{d}
For the multivariate case with $d \in \nat$ dimensions,
we proceed with the usual tensor product approach,
for which we replace all indices, points, and functions with
multi-indices, Cartesian products, and tensor products, respectively.
\usenotation{0!}
\usenotation{1!}
Therefore, the domain is now $\clint{\ß0, \ß1} := \clint{0, 1}^d$,
which can be partitioned into
$\prod_{t=1}^d 2^{l_t} = 2^{\normone{\vec{l}}}$ equally sized hypercubes,
where $\ßl = (l_1, \dotsc, l_d) \in \natz^d$ is the $d$-dimensional level
and $\normone{\vec{l}} := \sum_{t=1}^d l_t$ is the level sum.
The corners of the hypercubes are given by the grid points
\begin{equation}
  \label{eq:gridPointMultivariate}
  \vgp{\ßl,\ßi} := \ßi \cdot \vms{\ßl},\quad
  \ßi = \ß0, \dotsc, \ß2^{\ßl}.
\end{equation}
To allow for a somewhat intuitive and suggestive notation,
relations and operations with vectors (in bold face)
are to be read coordinate-wise in this thesis, unless stated otherwise.
Bold-faced numbers like $\ß0$ are defined to be the vector $(0, \dotsc, 0)$
in which every entry is equal to that number.
For example, \eqref{eq:gridPointMultivariate} is equivalent to
\begin{equation}
  \vgp{\ßl,\ßi}
  := (i_1 \ms{l_1},\; \dotsc,\; i_d \ms{l_d}),\quad
  i_t = 0, \dotsc, 2^{l_t},\quad
  t = 1, \dotsc, d,
\end{equation}
with the $d$-dimensional mesh size
$\vms{\ßl} := \ß2^{-\ßl} = (\ms{l_1}, \dotsc, \ms{l_d})$.
Again, every grid point is associated with a basis function that is defined
as the tensor product of the univariate functions:%
\footnote{%
  Note that one could employ basis functions of different types in
  each dimension, for example B-splines of different degrees.
  For simplicity, we first restrict ourselves to the case of a single type
  for all dimensions, but we will treat the more general case in
  \todo{insert reference}.%
}
\begin{equation}
  \basis{\ßl,\ßi}\colon \clint{\ß0, \ß1} \to \real,\quad
  \basis{\ßl,\ßi}(\ßx)
  := \prod_{t=1}^d \basis{l_t,i_t}(x_t).
\end{equation}
\cref{fig:nodalHat2D} shows an example of a bivariate nodal hat function
$\basis{\ßl,\ßi}^1$.

\begin{SCfigure}
  \includegraphics{nodalHat2D_1}%
  \caption{%
    Bivariate nodal hat function of level $\ßl = (2, 1)$ and
    index $i = (1, 1)$ as the tensor product of two univariate
    nodal hat functions.%
  }%
  \label{fig:nodalHat2D}%
\end{SCfigure}

\paragraph{Multivariate nodal space}

The multivariate nodal space $\ns{\ßl}$ is defined analogously to
the univariate case:
\begin{equation}
  \ns{\ßl}
  := \spn\{\basis{\ßl,\ßi} \mid \ßi = \ß0, \dotsc, \ß2^{\ßl}\}.
\end{equation}
In the case of hat functions $\basis{\ßl,\ßi}^1$,
the nodal space $\ns{\ßl}^1$ is the $d$-linear spline space
\cite{Hoellig13Approximation}, i.e.,
the space of all continuous functions
on $\clint{\ß0, \ß1}$ that are piecewise $d$-linear polynomials on
all hypercubes
\begin{equation}
  \clint{\vgp{\ßl,\ßi}, \vgp{\ßl,\ßi+\ß1}}
  := \clint{\gp{l_1,i_1}, \gp{l_1,i_1+1}} \times \dotsb \times
  \clint{\gp{l_d,i_d}, \gp{l_d,i_d+1}},\quad
  \ßi = \ß0, \dotsc, \ß2^\ßl - \ß1.
\end{equation}
Analogously to \eqref{eq:interpFullGridUV},
we can interpolate objective functions $f\colon \clint{\ß0, \ß1} \to \real$
in the nodal space $\ns{\ßl}$ with $\fgintp{\ßl}\colon \clint{\ß0, \ß1} \to \real$ satisfying
\begin{equation}
  \label{eq:interpFullGridMV}
  \fgintp{\ßl}
  = \sum_{\ßi=\ß0}^{\ß2^\ßl} \interpcoeff{\ßi} \basis{\ßl,\ßi},\quad
  \fa{\ßi = \ß0, \dotsc, \ß2^\ßl}{\fgintp{\ßl}(\vgp{\ßl,\ßi}) = f(\vgp{\ßl,\ßi})},
\end{equation}
where $\interpcoeff{\ßi} \in \real$ and
the sum is over all $\ßi = \ß0, \dotsc, \ß2^\ßl$.
\begin{lemma}[linear independence of tensor products]
  \label{lemma:tensorProductLinearIndependence}
  The functions $\basis{\ßl,\ßi}$ ($\ßi = \ß0, \dotsc, \ß2^\ßl$)
  form a basis of $\ns{\ßl}$, if the univariate functions
  $\basis{l_t,i_t}$ ($i_t = 0, \dotsc, 2^{l_t}$)
  form a basis of the univariate nodal space $\ns{l_t}$
  for $t = 1, \dotsc, d$.
\end{lemma}
\begin{proof}
  Assume that $\interpcoeff{\ßi} \in \real$ are chosen in \eqref{eq:interpFullGridMV}
  such that $\fgintp{\ßl} \equiv 0$.
  Then for all $\ßi' = \ß0, \dotsc, \ß2^\ßl$,
  we can evaluate \eqref{eq:interpFullGridMV} at $\vgp{\ßl,\ßi'}$ to obtain
  \begin{equation}
    \sum_{i_1=0}^{2^{l_1}}
    \left(\sum_{i_2=0}^{2^{l_2}} \dotsb
    \left(\sum_{i_d=0}^{2^{l_d}} \interpcoeff{\ßi} \basis{l_d,i_d}(\gp{l_d,i_d'})\right) \dotsb
    \basis{l_2,i_2}(\gp{l_2,i_2'})\right) \basis{l_1,i_1}(\gp{l_1,i_1'})
    = 0.
  \end{equation}
  We apply the linear independence in 1D ($x_1$ direction) to conclude that
  the sum over $i_2$ must vanish.
  Repeating this argument for all dimensions, we infer that $\interpcoeff{\ßi} = 0$
  for all~$\ßi = \ß0, \dotsc, \ß2^\ßl$,
  implying the linear independence of the functions $\basis{\ßl,\ßi}$.
\end{proof}
The lemma is equivalent to the statement that the coefficients $\interpcoeff{\ßi} \in \real$
exist for every objective function $f$ and are uniquely determined by
the values at the grid points
\begin{equation}
  \fgset{\ßl}
  := \{\vgp{\ßl,\ßi} \mid \ßi = \ß0, \dotsc, \ß2^{\ßl}\}.
\end{equation}
\usenotation{n}
A common choice for the level $\ßl$ is $n \cdot \ß1$ for some $n \in \natz$.
\usenotation{Vnd}
In this case, we replace ``$\ßl$'' in the subscripts with ``$n{,}d$''
(for example, $\ns{n,d} := \ns{n \cdot \ß1}$).
For the hat function basis $\basis{l,i}^1$,
it can be shown that the $L^2$ interpolation error of the interpolant
$f_{n,d}^1$ is given by
\begin{equation}
  \normLtwo{f - f_{n,d}^1} = \landauO{\ms{n}^2},
\end{equation}
i.e., the order of the interpolation error is quadratic in the mesh size
\multicite{Hoellig13Approximation,Bungartz04Sparse}.
